import{u as e,g as a}from"./chunk-wamFc5Ot.js";import{a as s}from"./chunk-Czrwg_dh.js";import{d as t,u as l,s as n,r,l as i,h as o,w as c,o as u,a as m,b as d,t as v,j as p,q as g,F as f,B as h,k as b}from"./chunk-Gl-Q_KUo.js";const k={class:"toast toast-top toast-end"},y={key:0,class:"alert alert-error"},w={key:1,class:"alert alert-success"},I={key:2,class:"alert alert-error"},x={class:""},C={for:"explore"},S=["accept"],j={class:"btn btn-primary btn-sm"},q={class:"p-0"},F={class:"flex items-center gap-8"},T={class:"avatar h-14"},_={class:"w-12 h-12 mask mask-squircle hover:w-14 hover:h-14"},B={class:"w-64"},D={class:"overflow-hidden font-bold whitespace-nowrap text-ellipsis"},L=["onClick"],N=t({__name:"ImageConfig",setup(t){const{t:N}=l(),U=e().globalConfig,{getImageList:z}=n(U),A=r("image/*"),E=r(0),G=i.createInstance({name:"imgStore"});async function H(e){if(!/image*/.test(e.target.files[0].type))return void(E.value=3);const{dataUrl:a,fileName:t}=await s(e.target.files[0]);G.setItem("".concat((new Date).getTime().toString(),"+").concat(t),a).then((()=>{E.value=1,async function(){(await G.keys()).length>0&&G.iterate(((e,a)=>{U.addImage({id:a,name:a,url:"Storage"})}))}()})).catch((()=>{E.value=2}))}return o((()=>{})),c((()=>E.value),(e=>{0!==e&&setTimeout((()=>{E.value=0}),2e3)})),(e,s)=>(u(),m(f,null,[d("div",k,[2===E.value?(u(),m("div",y,[d("span",null,v(p(N)("error.uploadFail")),1)])):g("",!0),1===E.value?(u(),m("div",w,[d("span",null,v(p(N)("error.uploadSuccess")),1)])):g("",!0),3===E.value?(u(),m("div",I,[d("span",null,v(p(N)("error.notImage")),1)])):g("",!0)]),d("div",null,[d("div",x,[d("label",C,[d("input",{id:"explore",type:"file",class:"",style:{display:"none"},accept:A.value,onChange:H},null,40,S),d("span",j,v(p(N)("button.upload")),1)])]),d("ul",q,[(u(!0),m(f,null,h(p(z),(e=>(u(),m("li",{key:e.id,class:"mb-3"},[d("div",F,[d("div",T,[d("div",_,[b(a,{"img-item":e},null,8,["img-item"])])]),d("div",B,[d("div",D,v(e.name),1)]),d("div",null,[d("button",{class:"btn btn-error btn-xs",onClick:a=>function(e){"Storage"===e.url&&G.removeItem(e.id).then((()=>{U.removeImage(e.id)})),U.removeImage(e.id)}(e)},v(p(N)("button.delete")),9,L)])])])))),128))])])],64))}});export{N as default};
